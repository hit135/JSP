<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        
        /*
    Intercepter

    1) 개요

            - Interceptor는 낚아채다의 의미를 가지고있다.

            - Interceptor는 Controller의 Handler가 실행되기 전이나 후에 추가적인 작업이 수행되어야 할때 

                사용한다. 즉, Client에서 Server로 들어온 Request 객체를, Controller의 Handler로 도달하기 전 

                가로채어, 원하는 추가 작업이나 로직을 수행 한 후 Handler(Handler : 사용자가 요청한 url에 따라 

                실행되어야 할 Method)로 보낼 수 있도록 해주는 Module이다.


    Web Context : 웹 어플리케이션 영역  , Spring Context : 디스패처이후의 영역

    2) Interceptor를 활용하여 얻을 수 있는 장점

            - 공통 코드 사용으로 코드 재사용성 증가

            - 메모리 낭비, 서버 부하 감소

            - 코드 누락에 대한 위험성 감소

    ​

    3) 인터셉터와 필터  차이

        3.1) 필터(Filter)의 용도 및 예시

            - 공통된 보안 및 인증/인가 관련 작업

            - 모든 요청에 대한 로깅 또는 감사

            - 이미지/데이터 압축 및 문자열 인코딩

            - Spring과 분리되어야 하는 기능

            - 필터에서는 기본적으로 스프링과 무관하게 전역적으로 처리해야 하는 작업들을 처리할 수 있다.

                대표적으로 보안 공통 작업이 있다. 필터는 인터셉터보다 앞단에서 동작하므로 전역적으로 해야하는 

                보안 검사(XSS 방어 등)를 하여 올바른 요청이 아닐 경우 차단을 할 수 있다. 그러면 스프링 컨테이너까지

                요청이 전달되지 못하고 차단되므로 안정성을 더욱 높일 수 있다. 또한 필터는 이미지나 데이터의 압축이나

                문자열 인코딩과 같이 웹 애플리케이션에 전반적으로 사용되는 기능을 구현하기에 적당하다. 

                대표적으로 필터(Filter)를 인증과 인가에 사용하는 도구로는 SpringSecurity가 있다

    ​

        3.2) 인터셉터(Interceptor)의 용도 및 예시

            - 세부적인 보안 및 인증/인가 공통 작업

            - API 호출에 대한 로깅 또는 감사

            - Controller로 넘겨주는 정보(데이터)의 가공

            - 인터셉터에서는 클라이언트의 요청과 관련되어 전역적으로 처리해야 하는 작업들을 처리할 수 있다.

                대표적으로 세부적으로 적용해야 하는 인증이나 인가와 같이 클라이언트 요청과 관련된 작업 등이 있다.

                예를 들어 특정 그룹의 사용자는 어떤 기능을 사용하지 못하는 경우가 있는데, 이러한 작업들은 

                컨트롤러로 넘어가기 전에 검사해야 하므로 인터셉터가 처리하기에 적합하다.

    

        3.3) 호출 시점

                - Filter는 DispatcherServlet이 실행되기 전 , Interceptor는 DispatcherServlet이 실행된 후

    ​

        3.4) 설정 위치

                - Filter는 web.xml , Interceptor는 spring-servlet.xml

    ​

    4) Interceptor  네 가지 Method

        4.1) PreHandle(HttpServletRequest request, HttpServletResponse response, Object handler)

            - Controller(RequestMapping 선언 Handler) 실행 직전에 동작하는 method.

            - return 값이 true일 경우 정상적으로 진행이 되고,

            - false일 경우 실행 종료 (Controller 진입 못함)

            - Parameter 중 Object handler는 HandlerMapping이 찾은 Controller Class 객체이다.

    ​

        4.2) PostHandle(HttpServletRequest request, HttpServletResponse response, Object handler

                    , ModelAndView modelAndView)

            - Controller 진입 후 View가 Rendering 되기 전 수행된다.

            - Parameter 중 ModelAndView modelAndView를 통해 화면 단에 들어가는 Data 등의 조작이 

                    가능하다.

    ​

        4.3) afterComplete(HttpServletRequest request, HttpServletResponse response, Object handler

                    , Exception ex)

            - Controller 진입 후 View가 정상적으로 Rendering 된 후 수행된다.

    ​

        4.4) afterConcurrentHandlingStarted(HttpServletRequest request, HttpServletResponse response

                    , Object handler)

            - Servlet 3.0부터 비동기 요청이 가능해지며 생겨난 method로,

            - 비동기 요청 시 PostHandle와 afterCompletion method를 수행하지 않고 이 메서드를 수행한다.



        */

    </script>
</body>
</html>